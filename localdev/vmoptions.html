---
layout: default
title: Virtual Machine Options
---

<p>The Vagrantfile comes with a set of configuration that are generally reasonable to develop locally. These 
include the following.</p>

<h4>Vagrant cachier</h4>
<p>If the <a href="https://github.com/fgrehm/vagrant-cachier" target="_blank">vagrant-cachier</a> plugin is 
available it will be mounted and used to speed up package downloads as well as Solr downloads.</p>
<p>Note: that in some cases there may be challenges installing vagrant-cachier due to interference with other 
gems. More information may be found at <a href="https://github.com/mitchellh/vagrant/issues/3794">https://github.com/mitchellh/vagrant/issues/3794</a>.
  
<h4>Networking</h4>
<p>The following ports are mapped by default:</p>
<ul>
  <li>80 <=> 8080 -- used for Varnish if installed, or the web server</li>
  <li>8080 <=> 8081 -- used for direct access to the web server if Varnish is installed</li>
  <li>8983 <=> 18983 -- used to access to the Solr admin panel</li>
  <li>3306 <=> 13306 -- used to access to MySQL</li>
  <li>1080 <=> 1080 -- used to access the Mailcatcher UI</li>
</ul>

<p>The VM is set to use private networking with a default IP address of <code>10.11.12.14</code>. Note: using private 
networking in this fashion will not allow multiple VMs with these settings to be run concurrently. SSH agent forwarding 
is also enabled by default.</p>

<h4>File sharing</h4>
<p>NFS is enabled for Linux and Macintosh OS X operating systems. It mounts the root directory of the project to 
<code>/vagrant</code> on the virtual machine. The NFS UID and GID are set to the UID and GID of the user who runs 
vagrant.</p>

<h4>Resources</h4>
<p>By default the VM is set to use 1736M of memory. This is set to avoid the typical 512M memory setting in Virtualbox.
This can be overridden by <a href="#localoverrides">Local Overrides</a></p>

<h4>Provisioning</h4>
<p>There are a number of provisioning steps that are taken when loading a Web Starter Kit virtual machine. There 
are shell scripts in <code>puppet/shell</code> that are intended to be relatively static with per-project custom 
scripts in <code>puppet/shell/custom</code>. In addition Puppet is used to handle the majority of VM configuration.</p>

<ul>
  <li>A shell script that is run before any other provisioners at <code>puppet/shell/pre-provision.sh</code> that at present only triggers 
  a custom script at <code>puppet/shell/custom/pre-provision.sh</code>
  <li>A shell script that installs librarian-puppet and dependencies on the VM at <code>puppet/shell/librarian-puppet-install.sh</code></li>
  <li>Puppet provisioning, the following variables are injected via Facter and available:
    <ul>
      <li>host_uid: the UID of the user running the vagrant process</li>
      <li>host_gid: the GID of the user running the vagrant process</li>
      <li>vagrant_user: the username of the user running the vagrant process</li>
    </ul>
  </li>
  <li>A shell script that runs bundler, NPM and bower if their configuration files exist at <code>puppet/shell/post-provision.sh</code>; 
  it also runs a custom shell script in <code>puppet/shell/custom/post-provision.sh</code> if it exists; this is 
  generally used to copy settings files and do other setup on a per-project basis</li>
</ul>

<h3><a name="localoverrides"></a>Local Overrides</h3>
<p>Because the Vagrantfile is intended to be versioned all team members will have the same configuration for their 
virtual machine. However in some cases different team members need to be able to adjust these settings, generally 
to account for different resources available on their machine. If it exists a <code>Vagrantfile.local</code> is 
included after the normal configuration. Since it's included last settings defined there will override the ones 
in the main Vagrantfile. For example, to reduce the memory usage of the VM to 1024M you would create a Vagrantfile.local 
with the following:

{% gist wwhurley/6194718f37318224ae5c %}

The <code>.gitignore</code> file will prevent this from being included in the repository. 
</p>

{% include menus/localdev.html %}